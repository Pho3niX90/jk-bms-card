function _taggedTemplateLiteral(e, t) {
  return t || (t = e.slice(0)), Object.freeze(Object.defineProperties(e, {
    raw: {
      value: Object.freeze(t)
    }
  }));
}

/******************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
/* global Reflect, Promise, SuppressedError, Symbol, Iterator */


function __decorate(decorators, target, key, desc) {
    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;
    if (typeof Reflect === "object" && typeof Reflect.decorate === "function") r = Reflect.decorate(decorators, target, key, desc);
    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;
    return c > 3 && r && Object.defineProperty(target, key, r), r;
}

typeof SuppressedError === "function" ? SuppressedError : function (error, suppressed, message) {
    var e = new Error(message);
    return e.name = "SuppressedError", e.error = error, e.suppressed = suppressed, e;
};

/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const t$2=globalThis,e$2=t$2.ShadowRoot&&(void 0===t$2.ShadyCSS||t$2.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,s$2=Symbol(),o$4=new WeakMap;let n$3 = class n{constructor(t,e,o){if(this._$cssResult$=true,o!==s$2)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=t,this.t=e;}get styleSheet(){let t=this.o;const s=this.t;if(e$2&&void 0===t){const e=void 0!==s&&1===s.length;e&&(t=o$4.get(s)),void 0===t&&((this.o=t=new CSSStyleSheet).replaceSync(this.cssText),e&&o$4.set(s,t));}return t}toString(){return this.cssText}};const r$3=t=>new n$3("string"==typeof t?t:t+"",void 0,s$2),i$3=(t,...e)=>{const o=1===t.length?t[0]:e.reduce(((e,s,o)=>e+(t=>{if(true===t._$cssResult$)return t.cssText;if("number"==typeof t)return t;throw Error("Value passed to 'css' function must be a 'css' function result: "+t+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(s)+t[o+1]),t[0]);return new n$3(o,t,s$2)},S$1=(s,o)=>{if(e$2)s.adoptedStyleSheets=o.map((t=>t instanceof CSSStyleSheet?t:t.styleSheet));else for(const e of o){const o=document.createElement("style"),n=t$2.litNonce;void 0!==n&&o.setAttribute("nonce",n),o.textContent=e.cssText,s.appendChild(o);}},c$2=e$2?t=>t:t=>t instanceof CSSStyleSheet?(t=>{let e="";for(const s of t.cssRules)e+=s.cssText;return r$3(e)})(t):t;

/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const{is:i$2,defineProperty:e$1,getOwnPropertyDescriptor:h$1,getOwnPropertyNames:r$2,getOwnPropertySymbols:o$3,getPrototypeOf:n$2}=Object,a$1=globalThis,c$1=a$1.trustedTypes,l$1=c$1?c$1.emptyScript:"",p$1=a$1.reactiveElementPolyfillSupport,d$1=(t,s)=>t,u$1={toAttribute(t,s){switch(s){case Boolean:t=t?l$1:null;break;case Object:case Array:t=null==t?t:JSON.stringify(t);}return t},fromAttribute(t,s){let i=t;switch(s){case Boolean:i=null!==t;break;case Number:i=null===t?null:Number(t);break;case Object:case Array:try{i=JSON.parse(t);}catch(t){i=null;}}return i}},f$1=(t,s)=>!i$2(t,s),b={attribute:true,type:String,converter:u$1,reflect:false,useDefault:false,hasChanged:f$1};Symbol.metadata??=Symbol("metadata"),a$1.litPropertyMetadata??=new WeakMap;let y$1 = class y extends HTMLElement{static addInitializer(t){this._$Ei(),(this.l??=[]).push(t);}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(t,s=b){if(s.state&&(s.attribute=false),this._$Ei(),this.prototype.hasOwnProperty(t)&&((s=Object.create(s)).wrapped=true),this.elementProperties.set(t,s),!s.noAccessor){const i=Symbol(),h=this.getPropertyDescriptor(t,i,s);void 0!==h&&e$1(this.prototype,t,h);}}static getPropertyDescriptor(t,s,i){const{get:e,set:r}=h$1(this.prototype,t)??{get(){return this[s]},set(t){this[s]=t;}};return {get:e,set(s){const h=e?.call(this);r?.call(this,s),this.requestUpdate(t,h,i);},configurable:true,enumerable:true}}static getPropertyOptions(t){return this.elementProperties.get(t)??b}static _$Ei(){if(this.hasOwnProperty(d$1("elementProperties")))return;const t=n$2(this);t.finalize(),void 0!==t.l&&(this.l=[...t.l]),this.elementProperties=new Map(t.elementProperties);}static finalize(){if(this.hasOwnProperty(d$1("finalized")))return;if(this.finalized=true,this._$Ei(),this.hasOwnProperty(d$1("properties"))){const t=this.properties,s=[...r$2(t),...o$3(t)];for(const i of s)this.createProperty(i,t[i]);}const t=this[Symbol.metadata];if(null!==t){const s=litPropertyMetadata.get(t);if(void 0!==s)for(const[t,i]of s)this.elementProperties.set(t,i);}this._$Eh=new Map;for(const[t,s]of this.elementProperties){const i=this._$Eu(t,s);void 0!==i&&this._$Eh.set(i,t);}this.elementStyles=this.finalizeStyles(this.styles);}static finalizeStyles(s){const i=[];if(Array.isArray(s)){const e=new Set(s.flat(1/0).reverse());for(const s of e)i.unshift(c$2(s));}else void 0!==s&&i.push(c$2(s));return i}static _$Eu(t,s){const i=s.attribute;return  false===i?void 0:"string"==typeof i?i:"string"==typeof t?t.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=false,this.hasUpdated=false,this._$Em=null,this._$Ev();}_$Ev(){this._$ES=new Promise((t=>this.enableUpdating=t)),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach((t=>t(this)));}addController(t){(this._$EO??=new Set).add(t),void 0!==this.renderRoot&&this.isConnected&&t.hostConnected?.();}removeController(t){this._$EO?.delete(t);}_$E_(){const t=new Map,s=this.constructor.elementProperties;for(const i of s.keys())this.hasOwnProperty(i)&&(t.set(i,this[i]),delete this[i]);t.size>0&&(this._$Ep=t);}createRenderRoot(){const t=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return S$1(t,this.constructor.elementStyles),t}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(true),this._$EO?.forEach((t=>t.hostConnected?.()));}enableUpdating(t){}disconnectedCallback(){this._$EO?.forEach((t=>t.hostDisconnected?.()));}attributeChangedCallback(t,s,i){this._$AK(t,i);}_$ET(t,s){const i=this.constructor.elementProperties.get(t),e=this.constructor._$Eu(t,i);if(void 0!==e&&true===i.reflect){const h=(void 0!==i.converter?.toAttribute?i.converter:u$1).toAttribute(s,i.type);this._$Em=t,null==h?this.removeAttribute(e):this.setAttribute(e,h),this._$Em=null;}}_$AK(t,s){const i=this.constructor,e=i._$Eh.get(t);if(void 0!==e&&this._$Em!==e){const t=i.getPropertyOptions(e),h="function"==typeof t.converter?{fromAttribute:t.converter}:void 0!==t.converter?.fromAttribute?t.converter:u$1;this._$Em=e,this[e]=h.fromAttribute(s,t.type)??this._$Ej?.get(e)??null,this._$Em=null;}}requestUpdate(t,s,i){if(void 0!==t){const e=this.constructor,h=this[t];if(i??=e.getPropertyOptions(t),!((i.hasChanged??f$1)(h,s)||i.useDefault&&i.reflect&&h===this._$Ej?.get(t)&&!this.hasAttribute(e._$Eu(t,i))))return;this.C(t,s,i);} false===this.isUpdatePending&&(this._$ES=this._$EP());}C(t,s,{useDefault:i,reflect:e,wrapped:h},r){i&&!(this._$Ej??=new Map).has(t)&&(this._$Ej.set(t,r??s??this[t]),true!==h||void 0!==r)||(this._$AL.has(t)||(this.hasUpdated||i||(s=void 0),this._$AL.set(t,s)),true===e&&this._$Em!==t&&(this._$Eq??=new Set).add(t));}async _$EP(){this.isUpdatePending=true;try{await this._$ES;}catch(t){Promise.reject(t);}const t=this.scheduleUpdate();return null!=t&&await t,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[t,s]of this._$Ep)this[t]=s;this._$Ep=void 0;}const t=this.constructor.elementProperties;if(t.size>0)for(const[s,i]of t){const{wrapped:t}=i,e=this[s];true!==t||this._$AL.has(s)||void 0===e||this.C(s,void 0,i,e);}}let t=false;const s=this._$AL;try{t=this.shouldUpdate(s),t?(this.willUpdate(s),this._$EO?.forEach((t=>t.hostUpdate?.())),this.update(s)):this._$EM();}catch(s){throw t=false,this._$EM(),s}t&&this._$AE(s);}willUpdate(t){}_$AE(t){this._$EO?.forEach((t=>t.hostUpdated?.())),this.hasUpdated||(this.hasUpdated=true,this.firstUpdated(t)),this.updated(t);}_$EM(){this._$AL=new Map,this.isUpdatePending=false;}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(t){return  true}update(t){this._$Eq&&=this._$Eq.forEach((t=>this._$ET(t,this[t]))),this._$EM();}updated(t){}firstUpdated(t){}};y$1.elementStyles=[],y$1.shadowRootOptions={mode:"open"},y$1[d$1("elementProperties")]=new Map,y$1[d$1("finalized")]=new Map,p$1?.({ReactiveElement:y$1}),(a$1.reactiveElementVersions??=[]).push("2.1.0");

/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const t$1=globalThis,i$1=t$1.trustedTypes,s$1=i$1?i$1.createPolicy("lit-html",{createHTML:t=>t}):void 0,e="$lit$",h=`lit$${Math.random().toFixed(9).slice(2)}$`,o$2="?"+h,n$1=`<${o$2}>`,r$1=document,l=()=>r$1.createComment(""),c=t=>null===t||"object"!=typeof t&&"function"!=typeof t,a=Array.isArray,u=t=>a(t)||"function"==typeof t?.[Symbol.iterator],d="[ \t\n\f\r]",f=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,v=/-->/g,_=/>/g,m=RegExp(`>|${d}(?:([^\\s"'>=/]+)(${d}*=${d}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),p=/'/g,g=/"/g,$=/^(?:script|style|textarea|title)$/i,y=t=>(i,...s)=>({_$litType$:t,strings:i,values:s}),x=y(1),T=Symbol.for("lit-noChange"),E=Symbol.for("lit-nothing"),A=new WeakMap,C=r$1.createTreeWalker(r$1,129);function P(t,i){if(!a(t)||!t.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==s$1?s$1.createHTML(i):i}const V=(t,i)=>{const s=t.length-1,o=[];let r,l=2===i?"<svg>":3===i?"<math>":"",c=f;for(let i=0;i<s;i++){const s=t[i];let a,u,d=-1,y=0;for(;y<s.length&&(c.lastIndex=y,u=c.exec(s),null!==u);)y=c.lastIndex,c===f?"!--"===u[1]?c=v:void 0!==u[1]?c=_:void 0!==u[2]?($.test(u[2])&&(r=RegExp("</"+u[2],"g")),c=m):void 0!==u[3]&&(c=m):c===m?">"===u[0]?(c=r??f,d=-1):void 0===u[1]?d=-2:(d=c.lastIndex-u[2].length,a=u[1],c=void 0===u[3]?m:'"'===u[3]?g:p):c===g||c===p?c=m:c===v||c===_?c=f:(c=m,r=void 0);const x=c===m&&t[i+1].startsWith("/>")?" ":"";l+=c===f?s+n$1:d>=0?(o.push(a),s.slice(0,d)+e+s.slice(d)+h+x):s+h+(-2===d?i:x);}return [P(t,l+(t[s]||"<?>")+(2===i?"</svg>":3===i?"</math>":"")),o]};class N{constructor({strings:t,_$litType$:s},n){let r;this.parts=[];let c=0,a=0;const u=t.length-1,d=this.parts,[f,v]=V(t,s);if(this.el=N.createElement(f,n),C.currentNode=this.el.content,2===s||3===s){const t=this.el.content.firstChild;t.replaceWith(...t.childNodes);}for(;null!==(r=C.nextNode())&&d.length<u;){if(1===r.nodeType){if(r.hasAttributes())for(const t of r.getAttributeNames())if(t.endsWith(e)){const i=v[a++],s=r.getAttribute(t).split(h),e=/([.?@])?(.*)/.exec(i);d.push({type:1,index:c,name:e[2],strings:s,ctor:"."===e[1]?H:"?"===e[1]?I:"@"===e[1]?L:k}),r.removeAttribute(t);}else t.startsWith(h)&&(d.push({type:6,index:c}),r.removeAttribute(t));if($.test(r.tagName)){const t=r.textContent.split(h),s=t.length-1;if(s>0){r.textContent=i$1?i$1.emptyScript:"";for(let i=0;i<s;i++)r.append(t[i],l()),C.nextNode(),d.push({type:2,index:++c});r.append(t[s],l());}}}else if(8===r.nodeType)if(r.data===o$2)d.push({type:2,index:c});else {let t=-1;for(;-1!==(t=r.data.indexOf(h,t+1));)d.push({type:7,index:c}),t+=h.length-1;}c++;}}static createElement(t,i){const s=r$1.createElement("template");return s.innerHTML=t,s}}function S(t,i,s=t,e){if(i===T)return i;let h=void 0!==e?s._$Co?.[e]:s._$Cl;const o=c(i)?void 0:i._$litDirective$;return h?.constructor!==o&&(h?._$AO?.(false),void 0===o?h=void 0:(h=new o(t),h._$AT(t,s,e)),void 0!==e?(s._$Co??=[])[e]=h:s._$Cl=h),void 0!==h&&(i=S(t,h._$AS(t,i.values),h,e)),i}class M{constructor(t,i){this._$AV=[],this._$AN=void 0,this._$AD=t,this._$AM=i;}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(t){const{el:{content:i},parts:s}=this._$AD,e=(t?.creationScope??r$1).importNode(i,true);C.currentNode=e;let h=C.nextNode(),o=0,n=0,l=s[0];for(;void 0!==l;){if(o===l.index){let i;2===l.type?i=new R(h,h.nextSibling,this,t):1===l.type?i=new l.ctor(h,l.name,l.strings,this,t):6===l.type&&(i=new z(h,this,t)),this._$AV.push(i),l=s[++n];}o!==l?.index&&(h=C.nextNode(),o++);}return C.currentNode=r$1,e}p(t){let i=0;for(const s of this._$AV) void 0!==s&&(void 0!==s.strings?(s._$AI(t,s,i),i+=s.strings.length-2):s._$AI(t[i])),i++;}}class R{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(t,i,s,e){this.type=2,this._$AH=E,this._$AN=void 0,this._$AA=t,this._$AB=i,this._$AM=s,this.options=e,this._$Cv=e?.isConnected??true;}get parentNode(){let t=this._$AA.parentNode;const i=this._$AM;return void 0!==i&&11===t?.nodeType&&(t=i.parentNode),t}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(t,i=this){t=S(this,t,i),c(t)?t===E||null==t||""===t?(this._$AH!==E&&this._$AR(),this._$AH=E):t!==this._$AH&&t!==T&&this._(t):void 0!==t._$litType$?this.$(t):void 0!==t.nodeType?this.T(t):u(t)?this.k(t):this._(t);}O(t){return this._$AA.parentNode.insertBefore(t,this._$AB)}T(t){this._$AH!==t&&(this._$AR(),this._$AH=this.O(t));}_(t){this._$AH!==E&&c(this._$AH)?this._$AA.nextSibling.data=t:this.T(r$1.createTextNode(t)),this._$AH=t;}$(t){const{values:i,_$litType$:s}=t,e="number"==typeof s?this._$AC(t):(void 0===s.el&&(s.el=N.createElement(P(s.h,s.h[0]),this.options)),s);if(this._$AH?._$AD===e)this._$AH.p(i);else {const t=new M(e,this),s=t.u(this.options);t.p(i),this.T(s),this._$AH=t;}}_$AC(t){let i=A.get(t.strings);return void 0===i&&A.set(t.strings,i=new N(t)),i}k(t){a(this._$AH)||(this._$AH=[],this._$AR());const i=this._$AH;let s,e=0;for(const h of t)e===i.length?i.push(s=new R(this.O(l()),this.O(l()),this,this.options)):s=i[e],s._$AI(h),e++;e<i.length&&(this._$AR(s&&s._$AB.nextSibling,e),i.length=e);}_$AR(t=this._$AA.nextSibling,i){for(this._$AP?.(false,true,i);t&&t!==this._$AB;){const i=t.nextSibling;t.remove(),t=i;}}setConnected(t){ void 0===this._$AM&&(this._$Cv=t,this._$AP?.(t));}}class k{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(t,i,s,e,h){this.type=1,this._$AH=E,this._$AN=void 0,this.element=t,this.name=i,this._$AM=e,this.options=h,s.length>2||""!==s[0]||""!==s[1]?(this._$AH=Array(s.length-1).fill(new String),this.strings=s):this._$AH=E;}_$AI(t,i=this,s,e){const h=this.strings;let o=false;if(void 0===h)t=S(this,t,i,0),o=!c(t)||t!==this._$AH&&t!==T,o&&(this._$AH=t);else {const e=t;let n,r;for(t=h[0],n=0;n<h.length-1;n++)r=S(this,e[s+n],i,n),r===T&&(r=this._$AH[n]),o||=!c(r)||r!==this._$AH[n],r===E?t=E:t!==E&&(t+=(r??"")+h[n+1]),this._$AH[n]=r;}o&&!e&&this.j(t);}j(t){t===E?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,t??"");}}class H extends k{constructor(){super(...arguments),this.type=3;}j(t){this.element[this.name]=t===E?void 0:t;}}class I extends k{constructor(){super(...arguments),this.type=4;}j(t){this.element.toggleAttribute(this.name,!!t&&t!==E);}}class L extends k{constructor(t,i,s,e,h){super(t,i,s,e,h),this.type=5;}_$AI(t,i=this){if((t=S(this,t,i,0)??E)===T)return;const s=this._$AH,e=t===E&&s!==E||t.capture!==s.capture||t.once!==s.once||t.passive!==s.passive,h=t!==E&&(s===E||e);e&&this.element.removeEventListener(this.name,this,s),h&&this.element.addEventListener(this.name,this,t),this._$AH=t;}handleEvent(t){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,t):this._$AH.handleEvent(t);}}class z{constructor(t,i,s){this.element=t,this.type=6,this._$AN=void 0,this._$AM=i,this.options=s;}get _$AU(){return this._$AM._$AU}_$AI(t){S(this,t);}}const j=t$1.litHtmlPolyfillSupport;j?.(N,R),(t$1.litHtmlVersions??=[]).push("3.3.0");const B=(t,i,s)=>{const e=s?.renderBefore??i;let h=e._$litPart$;if(void 0===h){const t=s?.renderBefore??null;e._$litPart$=h=new R(i.insertBefore(l(),t),t,void 0,s??{});}return h._$AI(t),h};

/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const s=globalThis;class i extends y$1{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0;}createRenderRoot(){const t=super.createRenderRoot();return this.renderOptions.renderBefore??=t.firstChild,t}update(t){const r=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(t),this._$Do=B(r,this.renderRoot,this.renderOptions);}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(true);}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(false);}render(){return T}}i._$litElement$=true,i["finalized"]=true,s.litElementHydrateSupport?.({LitElement:i});const o$1=s.litElementPolyfillSupport;o$1?.({LitElement:i});(s.litElementVersions??=[]).push("4.2.0");

/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const t=t=>(e,o)=>{ void 0!==o?o.addInitializer((()=>{customElements.define(t,e);})):customElements.define(t,e);};

/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */const o={attribute:true,type:String,converter:u$1,reflect:false,hasChanged:f$1},r=(t=o,e,r)=>{const{kind:n,metadata:i}=r;let s=globalThis.litPropertyMetadata.get(i);if(void 0===s&&globalThis.litPropertyMetadata.set(i,s=new Map),"setter"===n&&((t=Object.create(t)).wrapped=true),s.set(r.name,t),"accessor"===n){const{name:o}=r;return {set(r){const n=e.get.call(this);e.set.call(this,r),this.requestUpdate(o,n,t);},init(e){return void 0!==e&&this.C(o,void 0,t,e),e}}}if("setter"===n){const{name:o}=r;return function(r){const n=this[o];e.call(this,r),this.requestUpdate(o,n,t);}}throw Error("Unsupported decorator location: "+n)};function n(t){return (e,o)=>"object"==typeof o?r(t,e,o):((t,e,o)=>{const r=e.hasOwnProperty(o);return e.constructor.createProperty(o,t),r?Object.getOwnPropertyDescriptor(e,o):void 0})(t,e,o)}

const EDITOR_NAME='jk-bms-content-card-editor';const MAIN_NAME='jk-bms-card';var EntityKey;(function(EntityKey){EntityKey["delta_cell_voltage"]="delta_cell_voltage";EntityKey["balancing_current"]="balancing_current";EntityKey["power"]="power";EntityKey["balance_trigger_voltage"]="balance_trigger_voltage";EntityKey["total_runtime_formatted"]="total_runtime_formatted";EntityKey["charging"]="charging";EntityKey["discharging"]="discharging";EntityKey["balancer"]="balancer";EntityKey["heater"]="heater";EntityKey["total_voltage"]="total_voltage";EntityKey["total_battery_capacity_setting"]="total_battery_capacity_setting";EntityKey["total_charging_cycle_capacity"]="total_charging_cycle_capacity";EntityKey["average_cell_voltage"]="average_cell_voltage";EntityKey["current"]="current";EntityKey["state_of_charge"]="state_of_charge";EntityKey["capacity_remaining"]="capacity_remaining";EntityKey["charging_cycles"]="charging_cycles";EntityKey["power_tube_temperature"]="power_tube_temperature";EntityKey["min_voltage_cell"]="min_voltage_cell";EntityKey["max_voltage_cell"]="max_voltage_cell";EntityKey["errors"]="errors";EntityKey["cell_voltage_1"]="cell_voltage_1";EntityKey["cell_voltage_2"]="cell_voltage_2";EntityKey["cell_voltage_3"]="cell_voltage_3";EntityKey["cell_voltage_4"]="cell_voltage_4";EntityKey["cell_voltage_5"]="cell_voltage_5";EntityKey["cell_voltage_6"]="cell_voltage_6";EntityKey["cell_voltage_7"]="cell_voltage_7";EntityKey["cell_voltage_8"]="cell_voltage_8";EntityKey["cell_voltage_9"]="cell_voltage_9";EntityKey["cell_voltage_10"]="cell_voltage_10";EntityKey["cell_voltage_11"]="cell_voltage_11";EntityKey["cell_voltage_12"]="cell_voltage_12";EntityKey["cell_voltage_13"]="cell_voltage_13";EntityKey["cell_voltage_14"]="cell_voltage_14";EntityKey["cell_voltage_15"]="cell_voltage_15";EntityKey["cell_voltage_16"]="cell_voltage_16";EntityKey["cell_voltage_17"]="cell_voltage_17";EntityKey["cell_voltage_18"]="cell_voltage_18";EntityKey["cell_voltage_19"]="cell_voltage_19";EntityKey["cell_voltage_20"]="cell_voltage_20";EntityKey["cell_voltage_21"]="cell_voltage_21";EntityKey["cell_voltage_22"]="cell_voltage_22";EntityKey["cell_voltage_23"]="cell_voltage_23";EntityKey["cell_voltage_24"]="cell_voltage_24";EntityKey["cell_voltage_25"]="cell_voltage_25";EntityKey["cell_voltage_26"]="cell_voltage_26";EntityKey["cell_voltage_27"]="cell_voltage_27";EntityKey["cell_voltage_28"]="cell_voltage_28";EntityKey["cell_voltage_29"]="cell_voltage_29";EntityKey["cell_voltage_30"]="cell_voltage_30";EntityKey["cell_voltage_31"]="cell_voltage_31";EntityKey["cell_voltage_32"]="cell_voltage_32";EntityKey["cell_resistance_1"]="cell_resistance_1";EntityKey["cell_resistance_2"]="cell_resistance_2";EntityKey["cell_resistance_3"]="cell_resistance_3";EntityKey["cell_resistance_4"]="cell_resistance_4";EntityKey["cell_resistance_5"]="cell_resistance_5";EntityKey["cell_resistance_6"]="cell_resistance_6";EntityKey["cell_resistance_7"]="cell_resistance_7";EntityKey["cell_resistance_8"]="cell_resistance_8";EntityKey["cell_resistance_9"]="cell_resistance_9";EntityKey["cell_resistance_10"]="cell_resistance_10";EntityKey["cell_resistance_11"]="cell_resistance_11";EntityKey["cell_resistance_12"]="cell_resistance_12";EntityKey["cell_resistance_13"]="cell_resistance_13";EntityKey["cell_resistance_14"]="cell_resistance_14";EntityKey["cell_resistance_15"]="cell_resistance_15";EntityKey["cell_resistance_16"]="cell_resistance_16";EntityKey["cell_resistance_17"]="cell_resistance_17";EntityKey["cell_resistance_18"]="cell_resistance_18";EntityKey["cell_resistance_19"]="cell_resistance_19";EntityKey["cell_resistance_20"]="cell_resistance_20";EntityKey["cell_resistance_21"]="cell_resistance_21";EntityKey["cell_resistance_22"]="cell_resistance_22";EntityKey["cell_resistance_23"]="cell_resistance_23";EntityKey["cell_resistance_24"]="cell_resistance_24";EntityKey["cell_resistance_25"]="cell_resistance_25";EntityKey["cell_resistance_26"]="cell_resistance_26";EntityKey["cell_resistance_27"]="cell_resistance_27";EntityKey["cell_resistance_28"]="cell_resistance_28";EntityKey["cell_resistance_29"]="cell_resistance_29";EntityKey["cell_resistance_30"]="cell_resistance_30";EntityKey["cell_resistance_31"]="cell_resistance_31";EntityKey["cell_resistance_32"]="cell_resistance_32";EntityKey["temperature_sensor_1"]="temperature_sensor_1";EntityKey["temperature_sensor_2"]="temperature_sensor_2";EntityKey["temperature_sensor_3"]="temperature_sensor_3";EntityKey["temperature_sensor_4"]="temperature_sensor_4";})(EntityKey||(EntityKey={}));

var common = {
	title: "JK BMS Card",
	description: "A customizable Home Assistant card to emulate the JK BMS screen",
	version: "Version"
};
var config = {
	title: "Title",
	prefix: "Prefix of the sensors",
	cellCount: "Number of cells",
	cellColumns: "Number of columns",
	cellLayout: "Cell Layout",
	layout: "Layout",
	manualAssignment: "Manual entity assignment",
	tempSensorsCount: "Number of temperature sensors available",
	hasHeater: "Heater option is used"
};
var switches = {
	charge: "Charge",
	discharge: "Discharge",
	balance: "Balance",
	heater: "Heater"
};
var stats = {
	power: "Power:",
	capacity: "Capacity:",
	cycleCapacity: "Cycle Cap:",
	averageCellV: "Avg Cell V:",
	balanceCurrent: "Balance Cur:",
	stateOfCharge: "SOC:",
	remainingAmps: "Remaining:",
	cycles: "Cycles:",
	delta: "Delta V:",
	mosfetTemp: "MOS Temp:",
	temperature_sensor_1: "Temp. 1:",
	temperature_sensor_2: "Temp. 2:",
	temperature_sensor_3: "Temp. 3:",
	temperature_sensor_4: "Temp. 4:"
};
var en = {
	common: common,
	config: config,
	switches: switches,
	stats: stats
};

var en$1 = /*#__PURE__*/Object.freeze({
  __proto__: null,
  common: common,
  config: config,
  default: en,
  stats: stats,
  switches: switches
});

const globalData={hass:null};

const languages={en:en$1};function localize(string,search='',replace=''){try{const langFromLocalStorage=(localStorage.getItem('selectedLanguage')||'en').replace(/['"]+/g,'').replace('-','_');const lang="".concat(globalData.hass?.selectedLanguage||globalData.hass?.locale?.language||globalData.hass?.language||langFromLocalStorage);let translated;try{translated=string?.split('.').reduce((o,i)=>o[i],languages[lang]);}catch(e){translated=string?.split('.')?.reduce((o,i)=>o[i],languages['en']);}if(translated===undefined){translated=string?.split('.')?.reduce((o,i)=>o[i],languages['en']);}if(search!==''&&replace!==''){translated=translated.replace(search,replace);}return translated;}catch(e){return string;}}

var version = "1.1.0";

// eslint-disable-next-line @typescript-eslint/no-explicit-any
function fireEvent(node,type,detail,options){options=options||{};detail=detail===null||detail===undefined?{}:detail;const event=new Event(type,{bubbles:options.bubbles===undefined?true:options.bubbles,cancelable:Boolean(options.cancelable),composed:options.composed===undefined?true:options.composed});// eslint-disable-next-line @typescript-eslint/no-explicit-any
event.detail=detail;node.dispatchEvent(event);return event;}const configOrEnum=(config,entityId)=>{const configValue=config?.entities[entityId]?.toString()?.trim();return configValue&&configValue.length>1?configValue:entityId?.toString();};const navigate=(event,config,entityId,type="sensor")=>{if(!event){return;}event.stopPropagation();const configValue=configOrEnum(config,entityId);const fullEntityId=configValue.includes('sensor.')||configValue.includes('switch.')||configValue.includes('number.')?configValue:type+"."+config?.prefix+"_"+configValue;let customEvent=new CustomEvent('hass-more-info',{detail:{entityId:fullEntityId},composed:true});event.target.dispatchEvent(customEvent);};const getState=(hass,config,entityKey,precision=2,defaultValue='',type="sensor")=>{const configValue=configOrEnum(config,entityKey);if(!configValue)return defaultValue;const entityId=configValue.includes('sensor.')||configValue.includes('switch.')||configValue.includes('number.')?configValue:"".concat(type,".").concat(config.prefix,"_").concat(configValue);const entity=hass?.states[entityId];const state=entity?.state;const stateNumeric=Number(state);if(!isNaN(stateNumeric))return stateNumeric.toFixed(precision);return state??defaultValue;};

var _templateObject$3,_templateObject2$3,_templateObject3$2,_templateObject4$1,_templateObject5$1,_templateObject6$1,_templateObject7$1,_templateObject8$1,_templateObject9,_templateObject10,_templateObject11,_templateObject12,_templateObject13,_templateObject14;let JkBmsDefaultLayout=class JkBmsDefaultLayout extends i{constructor(){super(...arguments);this.minCellId='';this.maxCellId='';this.maxDeltaV=0.000;this.shouldBalance=false;}_navigate(event,entityId,type="sensor"){navigate(event,this.config,entityId,type);}getState(entityKey,precision=2,defaultValue='',type="sensor"){return getState(this.hass,this.config,entityKey,precision,defaultValue,type);}_renderSwitch(entityId,label){const state=this.getState(entityId,0,'',"switch");const colorClass=state==='on'?'status-on':'status-off';return x(_templateObject$3||(_templateObject$3=_taggedTemplateLiteral(["\n      <div class=\"button-border button-padding center clickable\" @click=",">\n        ",": <span class=\"","\">","</span>\n      </div>\n    "])),e=>this._navigate(e,entityId,"switch"),localize('switches.'+label),colorClass,state.toUpperCase());}configOrEnum(entityId){return configOrEnum(this.config,entityId);}render(){globalData.hass=this.hass;if(!this.hass||!this.config)return x(_templateObject2$3||(_templateObject2$3=_taggedTemplateLiteral([""])));const title=this.config.title||'Bat 1';this.maxDeltaV=parseFloat(this.getState(EntityKey.delta_cell_voltage,3,'0'));const balanceCurrent=parseFloat(this.getState(EntityKey.balancing_current,2,'0'));const powerNumber=parseFloat(this.getState(EntityKey.power,2,'0'));const triggerV=Number(this.getState(EntityKey.balance_trigger_voltage,2,"","number"));this.shouldBalance=this.maxDeltaV>=triggerV;const powerClass=powerNumber>0?'power-positive':powerNumber<0?'power-negative':'power-even';const balanceClass=balanceCurrent>0?'balance-positive':balanceCurrent<0?'balance-negative':'balance-even';const deltaClass=this.shouldBalance?'delta-needs-balancing':'delta-ok';const runtime=this.getState(EntityKey.total_runtime_formatted);const header=runtime&&runtime!="unknown"?x(_templateObject3$2||(_templateObject3$2=_taggedTemplateLiteral([" | Time: <b><font color=\"#3090C7\">","</font></b>"])),runtime.toUpperCase()):'';return x(_templateObject4$1||(_templateObject4$1=_taggedTemplateLiteral(["\n      <ha-card>\n        <div class=\"grid grid-1 p-3 section-padding\">\n          <div class=\"center clickable\" @click=",">\n            ","","\n          </div>\n        </div>\n\n        <div class=\"grid grid-","\">\n          ","\n          ","\n          ","\n          ","\n        </div>\n          \n          ","\n\n        <div class=\"grid grid-2 section-padding\">\n          <div class=\"stats-padding stats-border\">\n            <div class=\"clickable center\" @click=",">\n              <b><font color=\"#41CD52\" size=\"6\">"," V</font></b>\n            </div>\n              "," <span class=\"clickable ","\" @click=",">"," W</span><br>\n              "," <span class=\"clickable\" @click=",">"," Ah</span><br>\n              "," <span class=\"clickable\" @click=",">"," Ah</span><br>\n              "," <span class=\"clickable\" @click=",">"," V</span><br>\n              "," <span class=\"","\">"," A</span>\n              ","\n          </div>\n\n          <div class=\"stats-padding stats-border\">\n            <div class=\"clickable center\" @click=",">\n              <b><font color=\"#41CD52\" size=\"6\">"," A</font></b>\n            </div>\n              "," <span class=\"clickable\" @click=",">"," %</span><br>\n              "," <span class=\"clickable\" @click=",">"," Ah</span><br>\n              "," <span class=\"clickable\" @click=",">","</span><br>\n              "," <span class=\"","\" @click=","> "," V </span><br>\n              "," <span class=\"clickable\" @click=",">"," \xB0C</span>\n              ","\n          </div>\n        </div>\n\n          <svg class=\"flow-line\" id=\"flow-svg\">\n              <path id=\"flow-path\" fill=\"none\" />\n          </svg>\n\n          <div class=\"grid grid-","\">\n          ","\n        </div>\n      </ha-card>\n    "])),e=>this._navigate(e,EntityKey.total_runtime_formatted),title,header,this.config.hasHeater=='1'?'4':'3',this._renderSwitch(EntityKey.charging,'charge'),this._renderSwitch(EntityKey.discharging,'discharge'),this._renderSwitch(EntityKey.balancer,'balance'),this.config.hasHeater=='1'?this._renderSwitch(EntityKey.heater,'heater'):'',this._renderError(),e=>this._navigate(e,EntityKey.total_voltage),this.getState(EntityKey.total_voltage),localize('stats.power'),powerClass,e=>this._navigate(e,EntityKey.power),this.getState(EntityKey.power),localize('stats.capacity'),e=>this._navigate(e,EntityKey.total_battery_capacity_setting),this.getState(EntityKey.total_battery_capacity_setting),localize('stats.cycleCapacity'),e=>this._navigate(e,EntityKey.total_charging_cycle_capacity),this.getState(EntityKey.total_charging_cycle_capacity),localize('stats.averageCellV'),e=>this._navigate(e,EntityKey.average_cell_voltage),this.getState(EntityKey.average_cell_voltage,3),localize('stats.balanceCurrent'),balanceClass,balanceCurrent.toFixed(1),this._renderTemps(1),e=>this._navigate(e,EntityKey.current),this.getState(EntityKey.current),localize('stats.stateOfCharge'),e=>this._navigate(e,EntityKey.state_of_charge),this.getState(EntityKey.state_of_charge),localize('stats.remainingAmps'),e=>this._navigate(e,EntityKey.capacity_remaining),this.getState(EntityKey.capacity_remaining),localize('stats.cycles'),e=>this._navigate(e,EntityKey.charging_cycles),this.getState(EntityKey.charging_cycles),localize('stats.delta'),deltaClass,e=>this._navigate(e,EntityKey.delta_cell_voltage),this.maxDeltaV.toFixed(3),localize('stats.mosfetTemp'),e=>this._navigate(e,EntityKey.power_tube_temperature),this.getState(EntityKey.power_tube_temperature),this._renderTemps(2),this.config.cellColumns??2,this._renderCells(this.config.cellLayout=="bankMode"));}updated(){requestAnimationFrame(()=>this._updateFlowLine());}connectedCallback(){super.connectedCallback();window.addEventListener('resize',this._updateFlowLine.bind(this));}disconnectedCallback(){super.disconnectedCallback();window.removeEventListener('resize',this._updateFlowLine.bind(this));}_renderError(){const state=this.getState(EntityKey.errors,0);if(state.trim().length<=1||state=='0'){return x(_templateObject5$1||(_templateObject5$1=_taggedTemplateLiteral([""])));}return x(_templateObject6$1||(_templateObject6$1=_taggedTemplateLiteral(["<span class=\"error-message\">","</span>"])),state);}_renderTemps(placement){const sensors=[];const sensorsCount=this.config?.tempSensorsCount??0;for(let i=placement;i<=sensorsCount;i+=2){sensors.push(x(_templateObject7$1||(_templateObject7$1=_taggedTemplateLiteral(["\n                <br>"," <span class=\"clickable\" @click=",">"," \xB0C</span>"])),localize('stats.temperature_sensor_'+i),e=>this._navigate(e,EntityKey['temperature_sensor_'+i]),this.getState(EntityKey['temperature_sensor_'+i])));}return x(_templateObject8$1||(_templateObject8$1=_taggedTemplateLiteral(["",""])),sensors);}_renderCells(bankmode=true){const cells=[];const start=1;const columns=this.config?.cellColumns??2;const totalCells=this.config?.cellCount??16;const bankOffset=Math.floor(totalCells/columns);const end=bankmode?Math.ceil(totalCells/columns):totalCells;const uneven=totalCells%columns;this.minCellId=this.getState(EntityKey.min_voltage_cell,0);this.maxCellId=this.getState(EntityKey.max_voltage_cell,0);if(!this.minCellId||!this.maxCellId||!this.maxDeltaV||this.maxDeltaV==0||true){this.calculateDynamicMinMaxCellId(totalCells);}for(let i=start;i<=end;i++){if(bankmode&&uneven&&i==end){cells.push(this._createCell(totalCells));}else {cells.push(this._createCell(i));}if(bankmode&&(i<end||!uneven)){for(let ii=1;ii<columns;ii++){cells.push(this._createCell(i+bankOffset*ii));}}}return x(_templateObject9||(_templateObject9=_taggedTemplateLiteral(["",""])),cells);}calculateDynamicMinMaxCellId(totalCells){let minVoltage=Infinity;let maxVoltage=-Infinity;let minId=0;let maxId=0;for(let i=1;i<=totalCells;i++){const state=this.getState(EntityKey["cell_voltage_".concat(i)],3,'');const voltage=parseFloat(state);if(isNaN(voltage)){continue;}if(voltage>maxVoltage){maxVoltage=voltage;maxId=i;}if(voltage<minVoltage){minVoltage=voltage;minId=i;}}this.minCellId=String(minId);this.maxCellId=String(maxId);this.maxDeltaV=Number((maxVoltage-minVoltage).toFixed(3));}_createCell(i){const voltage=this.getState(EntityKey["cell_voltage_".concat(i)],3,'0.0');const resistance=this.getState(EntityKey["cell_resistance_".concat(i)],3);const minCell=this.minCellId;const maxCell=this.maxCellId;const color=i.toString()===minCell?'voltage-low':i.toString()===maxCell?'voltage-high':'';let resistanceHtml=resistance==''?'':x(_templateObject10||(_templateObject10=_taggedTemplateLiteral(["\n            <span class=\"clickable\" @click=",">\n            / "," \u03A9\n          </span>"])),e=>this._navigate(e,EntityKey["cell_resistance_".concat(i)]),resistance);return x(_templateObject11||(_templateObject11=_taggedTemplateLiteral(["\n            <div class=\"center cell-container\" id=\"cell-","\">\n            <span class=\"clickable\" @click=",">\n                <span class=\"pill\">","</span>\n            ","\n          </span>\n                ","\n            </div>\n        "])),i,e=>this._navigate(e,EntityKey["cell_voltage_".concat(i)]),i.toString().padStart(2,'0'),color?x(_templateObject12||(_templateObject12=_taggedTemplateLiteral(["<span class=\"","\">"," V</span>"])),color,voltage):x(_templateObject13||(_templateObject13=_taggedTemplateLiteral([""," V"])),voltage),resistanceHtml);}_updateFlowLine(){const balanceCurrent=parseFloat(this.getState(EntityKey.balancing_current,3,'0'));const minEl=this.renderRoot.querySelector("#cell-".concat(this.minCellId));const maxEl=this.renderRoot.querySelector("#cell-".concat(this.maxCellId));const path=this.renderRoot.querySelector('#flow-path');if(!path)return;if(!this.shouldBalance&&balanceCurrent===0||!minEl||!maxEl){path.setAttribute('d','');path.style.display='none';return;}path.style.display='inline';const hostEl=this.renderRoot instanceof ShadowRoot?this.renderRoot.host:this;const cardRect=hostEl.getBoundingClientRect();const minRect=minEl.getBoundingClientRect();const maxRect=maxEl.getBoundingClientRect();const getSideAnchor=rect=>{const centerX=rect.left+rect.width/2;const midCardX=cardRect.left+cardRect.width/2;const side=centerX<midCardX?'right':'left';const x=side==='right'?rect.right-cardRect.left:rect.left-cardRect.left;const y=rect.top+rect.height/2-cardRect.top;return {side,x,y};};const from=getSideAnchor(maxRect);const to=getSideAnchor(minRect);const horizontalOffset=10;let d;if(from.side===to.side){const elbowX=from.side==='right'?from.x+horizontalOffset:from.x-horizontalOffset;d="M ".concat(from.x,",").concat(from.y,"\n             L ").concat(elbowX,",").concat(from.y,"\n             L ").concat(elbowX,",").concat(to.y,"\n             L ").concat(to.x,",").concat(to.y);}else {const midX=(from.x+to.x)/2;d="M ".concat(from.x,",").concat(from.y,"\n             L ").concat(midX,",").concat(from.y,"\n             L ").concat(midX,",").concat(to.y,"\n             L ").concat(to.x,",").concat(to.y);}path.setAttribute('d',d);}};JkBmsDefaultLayout.styles=i$3(_templateObject14||(_templateObject14=_taggedTemplateLiteral(["\n        .grid {\n            display: grid;\n            gap: 4px;\n            margin: 4px;\n        }\n        .grid-1 { grid-template-columns: 1fr; }\n        .grid-2 { grid-template-columns: repeat(2, 1fr); }\n        .grid-3 { grid-template-columns: repeat(3, 1fr); }\n        .grid-4 { grid-template-columns: repeat(4, 1fr); }\n        .grid-5 { grid-template-columns: repeat(5, 1fr); }\n        .grid-6 { grid-template-columns: repeat(6, 1fr); }\n        .grid-7 { grid-template-columns: repeat(7, 1fr); }\n        .grid-8 { grid-template-columns: repeat(8, 1fr); }\n        .clickable {\n            cursor: pointer;\n        }\n        .section-padding {\n            padding-top: 0.45rem;\n            padding-bottom: 0.75rem;\n        }\n        .stats-padding {\n            padding-top: 0.75rem;\n            padding-left: 0.75rem;\n        }\n        .power-negative {\n            color: red\n        }\n        .power-positive {\n            color: #41cd52\n        }\n        .power-even {\n            color: #808080\n        }\n        .balance-positive {\n            color: red\n        }\n        .balance-negative {\n            color: #3090C7\n        }\n        .balance-even {\n            color: #808080\n        }\n        .delta-needs-balancing {\n            color: #FFA500\n        }\n        .delta-ok {\n            color: #41CD52\n        }\n        .stats-border {\n            border-width: var(--ha-card-border-width, 1px);\n            border-style: solid;\n            border-color: var(--ha-card-border-color, var(--divider-color, #e0e0e0));\n        }\n        .button-border {\n            border-width: var(--ha-card-border-width, 1px);\n            border-style: solid;\n            border-color: var(--ha-card-border-color, var(--divider-color, #e0e0e0));\n        }\n        .error-message {\n            color: red;\n            font-style: italic;\n        }\n        .button-padding {\n            padding-top: 0.75rem;\n            padding-bottom: 0.75rem;\n        }\n        .status-on { color: #41cd52; }\n        .status-off { color: red; }\n        .voltage-high { color: #3090C7; }\n        .voltage-low { color: red; }\n        .center { text-align: center; }\n        .pill {\n            display: inline-block;\n            padding: 0.15rem 0.25rem;\n            background-color: #195569;\n            color: #e4f3f8;\n            border-radius: 999px;\n            font-weight: 500;\n            font-family: sans-serif;\n            font-size: 0.9rem;\n            min-width: 2rem;\n            text-align: center;\n        }\n        .flow-line {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            pointer-events: none;\n            z-index: 1;\n        }\n        \n        line {\n            stroke: #3090C7;\n            stroke-width: 2;\n            stroke-dasharray: 6;\n            animation: dashmove 1s linear infinite;\n            filter: drop-shadow(0 0 4px #41cd52);\n        }\n        path {\n            stroke: #3090C7;\n            stroke-width: 3;\n            stroke-linecap: round;\n            fill: none;\n            stroke-dasharray: 10;\n            stroke-dashoffset: 0;\n            animation: dashmove 1.2s linear infinite;\n            filter: drop-shadow(0 0 4px #41cd52);\n         }\n\n        @keyframes dashmove {\n            from {\n                stroke-dashoffset: 0;\n            }\n            to {\n                stroke-dashoffset: -20;\n            }\n        }\n    "])));__decorate([n()],JkBmsDefaultLayout.prototype,"hass",void 0);__decorate([n()],JkBmsDefaultLayout.prototype,"config",void 0);JkBmsDefaultLayout=__decorate([t('jk-bms-default-layout')],JkBmsDefaultLayout);

var _templateObject$2,_templateObject2$2,_templateObject3$1,_templateObject4,_templateObject5,_templateObject6,_templateObject7,_templateObject8;let JkBmsCoreReactorLayout=class JkBmsCoreReactorLayout extends i{constructor(){super(...arguments);this.minCellId='';this.maxCellId='';this.maxDeltaV=0.000;this.shouldBalance=false;this.historyData={};}firstUpdated(){this.fetchHistory();this._historyInterval=window.setInterval(()=>this.fetchHistory(),60000);// Update every minute
}_navigate(event,entityId,type="sensor"){navigate(event,this.config,entityId,type);}updated(changedProps){if(changedProps.has('hass')){this._updateRealtimeHistory();}}_updateRealtimeHistory(){if(!this.hass||!this.config)return;const keys=[EntityKey.total_voltage,EntityKey.current,EntityKey.power_tube_temperature,EntityKey.delta_cell_voltage];const now=Date.now();const oneHourAgo=now-60*60*1000;keys.forEach(key=>{const entityId=this._resolveEntityId(key);if(!entityId)return;const stateObj=this.hass.states[entityId];if(!stateObj)return;const val=parseFloat(stateObj.state);const time=new Date(stateObj.last_updated).getTime();if(isNaN(val))return;const currentHistory=this.historyData[entityId]||[];const lastEntry=currentHistory.length>0?currentHistory[currentHistory.length-1]:null;// Only append if it's a new update (time > last time)
if(!lastEntry||time>lastEntry.time){// Create new array to trigger reactivity if needed, or just push
// For Lit reactivity on objects/arrays, purely pushing might not trigger unless we reassign or requestUpdate
// But efficient way is:
const newHistoryList=[...currentHistory,{state:val,time:time}];// Prune old
while(newHistoryList.length>0&&newHistoryList[0].time<oneHourAgo){newHistoryList.shift();}this.historyData={...this.historyData,[entityId]:newHistoryList};}});}disconnectedCallback(){super.disconnectedCallback();if(this._historyInterval){clearInterval(this._historyInterval);}}async fetchHistory(){if(!this.hass||!this.config)return;const entitiesToFetch=[this._resolveEntityId(EntityKey.total_voltage),this._resolveEntityId(EntityKey.current),this._resolveEntityId(EntityKey.power_tube_temperature),this._resolveEntityId(EntityKey.delta_cell_voltage)].filter(e=>e);// Deduplicate
const uniqueEntities=[...new Set(entitiesToFetch)];if(uniqueEntities.length===0)return;const endTime=new Date();const startTime=new Date(endTime.getTime()-60*60*1000);// 1 hour ago
try{// Using WebSocket API for history
const response=await this.hass.callWS({type:'history/history_during_period',start_time:startTime.toISOString(),end_time:endTime.toISOString(),entity_ids:uniqueEntities,minimal_response:true,no_attributes:true});if(response){const newHistory={};// Response is an object: { "entity_id": [ { s: state, lu: last_updated_timestamp }, ... ] }
// or just standard history objects depending on HA version, but 'minimal_response' gives shorthand.
Object.keys(response).forEach(entityId=>{const historyList=response[entityId];if(Array.isArray(historyList)){newHistory[entityId]=historyList.map(entry=>({// 's' is state, 'lu' is last_updated (seconds since epoch)
state:parseFloat(entry.s||entry.state),time:(entry.lu||new Date(entry.last_updated).getTime()/1000)*1000})).filter(e=>!isNaN(e.state));}});this.historyData={...this.historyData,...newHistory};}}catch(e){console.warn("JK BMS Card: Failed to fetch history via WS",e);}}configOrEnum(entityId){return configOrEnum(this.config,entityId);}_resolveEntityId(entityKey){const configValue=this.configOrEnum(entityKey);if(!configValue)return undefined;// Logic must match getState: if regular entity_id (contains dot), use as is.
// Otherwise assume it's a suffix and prepend sensor.<prefix>_
return configValue.includes('.')?configValue:"sensor.".concat(this.config.prefix,"_").concat(configValue);}_renderSparkline(entityKey,color){const entityId=this._resolveEntityId(entityKey);if(!entityId||!this.historyData[entityId]||this.historyData[entityId].length<2){return x(_templateObject$2||(_templateObject$2=_taggedTemplateLiteral(["<div style=\"height: 30px;\"></div>"])));}const data=this.historyData[entityId];// Calculate min/max for scaling
let min=Infinity;let max=-Infinity;data.forEach(d=>{const cState=Number(Number(d.state).toFixed(3));if(cState<min)min=cState;if(cState>max)max=cState;});console.log("Sparkline: ".concat(entityKey," min/max: ").concat(min,"/").concat(max));// Add 5% padding to min/max to avoid flatlining at edges unless flat
let range=max-min;// Enforce min_ange to prevent noise amplification
const MIN_RANGE=1.0;if(range<MIN_RANGE){const center=(min+max)/2;min=center-MIN_RANGE/2;max=center+MIN_RANGE/2;}else {min-=range*0.05;max+=range*0.05;}// Generate SVG Path
// X axis: Time (normalized 0 to 100)
// Y axis: State (normalized 0 to 100, inverted)
const startTime=data[0].time;const endTime=data[data.length-1].time;const timeRange=endTime-startTime;if(timeRange<=0)return x(_templateObject2$2||(_templateObject2$2=_taggedTemplateLiteral([""])));let pathD='';data.forEach((pt,i)=>{const x=(pt.time-startTime)/timeRange*100;const y=100-(pt.state-min)/(max-min)*100;pathD+="".concat(i===0?'M':'L'," ").concat(x.toFixed(1),",").concat(y.toFixed(1)," ");});return x(_templateObject3$1||(_templateObject3$1=_taggedTemplateLiteral(["\n            <div class=\"sparkline-container\">\n                <svg class=\"sparkline-svg\" viewBox=\"0 0 100 100\" preserveAspectRatio=\"none\">\n                    <path class=\"spark-line\" d=\"","\" stroke=\"","\" />\n                    <path class=\"spark-area\" d=\""," L 100,100 L 0,100 Z\" fill=\"","\" />\n                </svg>\n            </div>\n        "])),pathD,color,pathD,color);}getState(entityKey,precision=2,defaultValue='',type="sensor"){return getState(this.hass,this.config,entityKey,precision,defaultValue,type);}render(){globalData.hass=this.hass;if(!this.hass||!this.config)return x(_templateObject4||(_templateObject4=_taggedTemplateLiteral([""])));const title=this.config.title||'Bat 1';const runtime=this.getState(EntityKey.total_runtime_formatted);const header=runtime&&runtime!="unknown"?x(_templateObject5||(_templateObject5=_taggedTemplateLiteral([" | Time: <b>","</b>"])),runtime.toUpperCase()):'';const current=parseFloat(this.getState(EntityKey.current));// Flow Logic: 
// Charge (Grid -> SOC) when current > 0
// Discharge (SOC -> Load) when current < 0
const isChargingFlow=current>0;const isDischargingFlow=current<0;const isCharging=this.getState(EntityKey.charging,0,'','switch')==='on';const isDischarging=this.getState(EntityKey.discharging,0,'','switch')==='on';// Stats
const soc=this.getState(EntityKey.state_of_charge);this.getState(EntityKey.total_battery_capacity_setting);// const current = parseFloat(this.getState(EntityKey.current)); // Already fetched above
const totalVolts=this.getState(EntityKey.total_voltage);const mosTemp=this.getState(EntityKey.power_tube_temperature);this.calculateDynamicMinMax();return x(_templateObject6||(_templateObject6=_taggedTemplateLiteral(["\n            <ha-card class=\"container\">\n                <div class=\"header clickable\" @click=",">\n                    "," ","\n                </div>\n\n                <div class=\"top-section\">\n                    <!-- Solar/Grid Node -->\n                    <div class=\"flow-node\">\n                        <div class=\"icon-circle clickable\" @click=",">\n                            <ha-icon icon=\"mdi:solar-power\"></ha-icon>\n                        </div>\n                        <div class=\"node-label\">Grid/Solar</div>\n                        <div class=\"node-status\">\n                            Charge: <span class=\"","\">","</span>\n                        </div>\n                    </div>\n\n                    <!-- Reactor (SOC) -->\n                    <div class=\"reactor-container\">\n                        <div class=\"reactor-ring clickable\" @click=",">\n                            <div class=\"soc-label\">SOC:</div>\n                            <div class=\"soc-value\">","%</div>\n                            <div class=\"capacity-val clickable\" @click=",">\n                                Remaining:<br>"," Ah\n                            </div>\n                        </div>\n                    </div>\n\n                    <!-- Load Node -->\n                    <div class=\"flow-node\">\n                        <div class=\"icon-circle clickable\" @click=",">\n                             <ha-icon icon=\"mdi:power-plug\"></ha-icon>\n                        </div>\n                        <div class=\"node-label\">Load</div>\n                        <div class=\"node-status\">\n                            Discharge: <span class=\"","\">","</span>\n                        </div>\n                    </div>\n\n                    <!-- SVG Flow Lines -->\n                    <svg class=\"flow-svg\" viewBox=\"0 0 400 180\" preserveAspectRatio=\"none\">\n                         <!-- Left path (Charge) - Rough coordinates for now, will refine -->\n                         <path d=\"M 60,70 Q 120,70 125,90\" class=\"","\" />\n                         <!-- Right path (Discharge) -->\n                         <path d=\"M 275,90 Q 280,70 340,70\" class=\"","\" marker-end=\"url(#arrow)\" />\n                         \n                         <defs>\n                            <marker id=\"arrow\" markerWidth=\"10\" markerHeight=\"10\" refX=\"8\" refY=\"3\" orient=\"auto\" markerUnits=\"strokeWidth\">\n                              <path d=\"M0,0 L0,6 L9,3 z\" fill=\"","\" />\n                            </marker>\n                         </defs>\n                    </svg>\n                </div>\n\n                <!-- Stats Panels -->\n                <div class=\"middle-grid\">\n                    <div class=\"stats-panel\">\n                        <div class=\"metric-group\">\n                             ","\n                             <div class=\"stat-label\">Total Voltage:</div>\n                             <div class=\"stat-value val-white clickable\" @click=",">"," V</div>\n                        </div>\n                        \n                        <div class=\"metric-group\">\n                             ","\n                             <div class=\"stat-label\">Current:</div>\n                             <div class=\"stat-value val-white clickable\" @click=",">"," A</div>\n                        </div>\n                    </div>\n\n                    <div class=\"stats-panel\">\n                         <div class=\"metric-group\">\n                             ","\n                             <div class=\"stat-label\">MOS Temp:</div>\n                             <div class=\"stat-value val-white clickable\" @click=",">"," \xB0C</div>\n                         </div>\n                         \n                         <div class=\"metric-group\">\n                             ","\n                             <div class=\"stat-label\">Delta V:</div>\n                             <div class=\"stat-value val-green clickable\" @click=",">"," V</div>\n                         </div>\n                    </div>\n                </div>\n\n                <!-- Cells -->\n                <div class=\"cell-grid\">\n                    ","\n                </div>\n\n            </ha-card>\n        "])),e=>this._navigate(e,EntityKey.total_runtime_formatted),title,header,e=>this._navigate(e,EntityKey.charging,'switch'),isCharging?'status-on':'status-off',isCharging?'ON':'OFF',e=>this._navigate(e,EntityKey.state_of_charge),soc,e=>this._navigate(e,EntityKey.capacity_remaining),this.getState(EntityKey.capacity_remaining),e=>this._navigate(e,EntityKey.discharging,'switch'),isDischarging?'status-on':'status-off',isDischarging?'ON':'OFF',isChargingFlow?'path-charge':'path-inactive',isDischargingFlow?'path-discharge':'path-inactive',isDischarging?'#3090c7':'#444',this._renderSparkline(EntityKey.total_voltage,'#41CD52'),e=>this._navigate(e,EntityKey.total_voltage),totalVolts,this._renderSparkline(EntityKey.current,'#3090c7'),e=>this._navigate(e,EntityKey.current),current,this._renderSparkline(EntityKey.power_tube_temperature,'#FFA500'),e=>this._navigate(e,EntityKey.power_tube_temperature),mosTemp,this._renderSparkline(EntityKey.delta_cell_voltage,'#41CD52'),e=>this._navigate(e,EntityKey.delta_cell_voltage),this.maxDeltaV,this._renderCells());}calculateDynamicMinMax(){// Logic reused/adapted from default layout to find min/max cell for highlighting
// For now, simplified version
let minV=100,maxV=0;let minId='',maxId='';const count=this.config.cellCount||16;for(let i=1;i<=count;i++){const v=parseFloat(this.getState(EntityKey["cell_voltage_".concat(i)],3,'0'));if(v>0){if(v<minV){minV=v;minId=String(i);}if(v>maxV){maxV=v;maxId=String(i);}}}this.minCellId=minId;this.maxCellId=maxId;this.maxDeltaV=parseFloat((maxV-minV).toFixed(3));}_renderCells(){const cells=[];const count=this.config.cellCount||16;for(let i=1;i<=count;i++){const v=this.getState(EntityKey["cell_voltage_".concat(i)],3,'0.000');const r=this.getState(EntityKey["cell_resistance_".concat(i)],3,'0.000');// Highlight logic
const isMin=String(i)===this.minCellId;const isMax=String(i)===this.maxCellId;let valClass=isMin?'cell-low':isMax?'cell-high':'val-white';// Custom pill background if needed for highlighting min/max row?
// For now just standard
// Progress Bar Logic
const vParam=parseFloat(v);const minLimit=2.8;// Approximate LFP lower working voltage
const maxLimit=3.65;// User specified 3.6 approx, standardized to 3.65 for LFP
let percent=0;if(!isNaN(vParam)){percent=(vParam-minLimit)/(maxLimit-minLimit)*100;if(percent<0)percent=0;if(percent>100)percent=100;}cells.push(x(_templateObject7||(_templateObject7=_taggedTemplateLiteral(["\n                <div class=\"cell-item\">\n                    <div class=\"cell-item-bg\" style=\"width: ","%;\"></div>\n                    <div style=\"display:flex; align-items:center;\">\n                        <span class=\"cell-id\">","</span>\n                        <span class=\"cell-volts "," clickable\" @click=",">"," V</span>\n                    </div>\n                    <span class=\"cell-res clickable\" @click=",">/ "," \u03A9</span>\n                </div>\n            "])),percent,String(i).padStart(2,'0'),valClass,e=>this._navigate(e,EntityKey["cell_voltage_".concat(i)]),v,e=>this._navigate(e,EntityKey["cell_resistance_".concat(i)]),r));}return cells;}};JkBmsCoreReactorLayout.styles=i$3(_templateObject8||(_templateObject8=_taggedTemplateLiteral(["\n        :host {\n            --primary-text-color: #e1e1e1;\n            --secondary-text-color: #9b9b9b;\n            --accent-color: #41cd52;\n            --accent-color-dim: rgba(65, 205, 82, 0.2);\n            --discharge-color: #3090c7;\n            --discharge-color-dim: rgba(48, 144, 199, 0.2);\n            --panel-bg: rgba(255, 255, 255, 0.05);\n            --panel-border: 1px solid rgba(255, 255, 255, 0.1);\n        }\n\n        .container {\n            font-family: 'Roboto', sans-serif;\n            color: var(--primary-text-color);\n            padding: 8px;\n            box-sizing: border-box;\n            background: #1c1c1c; /* Fallback/Base dark */\n            border-radius: var(--ha-card-border-radius, 12px);\n        }\n\n        .header {\n            text-align: center;\n            font-size: 1.1em;\n            margin-bottom: 16px;\n            color: var(--secondary-text-color);\n        }\n\n        .header b {\n            color: var(--discharge-color);\n        }\n\n        /* Top Section: Flow & Reactor */\n        .top-section {\n            display: grid;\n            grid-template-columns: 1fr 1.2fr 1fr;\n            align-items: center;\n            margin-bottom: 16px;\n            position: relative;\n            height: 180px;\n        }\n\n        .flow-node {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            z-index: 2;\n        }\n\n        .icon-circle {\n            width: 50px;\n            height: 50px;\n            border-radius: 50%;\n            border: 2px solid var(--secondary-text-color);\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            margin-bottom: 4px;\n            background: #2a2a2a;\n        }\n        \n        .icon-circle ha-icon {\n            --mdc-icon-size: 30px;\n        }\n\n        .node-label {\n            font-size: 0.9em;\n            color: var(--secondary-text-color);\n        }\n\n        .node-status {\n            font-size: 0.85em;\n        }\n\n        .reactor-container {\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            position: relative;\n            z-index: 2;\n        }\n\n        .reactor-ring {\n            width: 140px;\n            height: 140px;\n            border-radius: 50%;\n            border: 6px solid var(--accent-color);\n            box-shadow: 0 0 15px var(--accent-color-dim);\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            background: radial-gradient(circle, rgba(65,205,82,0.1) 0%, rgba(0,0,0,0) 70%);\n        }\n\n        .soc-label {\n            font-size: 0.9em;\n            color: var(--secondary-text-color);\n        }\n\n        .soc-value {\n            font-size: 2.2em;\n            font-weight: bold;\n            color: var(--accent-color);\n        }\n\n        .capacity-val {\n            font-size: 0.85em;\n            color: var(--secondary-text-color);\n            margin-top: -4px;\n        }\n\n        /* Middle Grid */\n        .middle-grid {\n            display: grid;\n            grid-template-columns: 1fr 1fr;\n            gap: 8px;\n            margin-bottom: 16px;\n        }\n\n        .stats-panel {\n            background: var(--panel-bg);\n            border: var(--panel-border);\n            border-radius: 10px;\n            padding: 10px;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            text-align: center;\n        }\n\n        .stat-label {\n            font-size: 0.85em;\n            color: var(--secondary-text-color);\n            margin-bottom: 4px;\n        }\n        \n        .stat-value {\n            font-size: 1.4em;\n            font-weight: bold;\n        }\n        \n        .stat-sub {\n            font-size: 0.8em;\n            color: var(--secondary-text-color);\n            margin-top: 2px;\n        }\n\n        .val-white { color: #fff; }\n        .val-green { color: var(--accent-color); }\n        .val-blue { color: var(--discharge-color); }\n        .val-orange { color: orange; }\n\n        /* Cell Grid */\n        .cell-grid {\n            display: grid;\n            grid-template-columns: repeat(2, 1fr);\n            gap: 6px;\n        }\n        \n        .cell-item {\n            background: #2a2a2a;\n            border-radius: 20px;\n            padding: 6px 12px;\n            display: flex;\n            align-items: center;\n            justify-content: space-between;\n            font-size: 0.95em;\n            position: relative;\n            overflow: hidden;\n            z-index: 0;\n        }\n\n        .cell-item-bg {\n             position: absolute;\n             top: 0;\n             left: 0;\n             height: 100%;\n             background: rgba(48, 144, 199, 0.2);\n             z-index: -1;\n             transition: width 0.5s ease-out;\n        }\n\n        .cell-id {\n            background: #37474f;\n            color: #b0bec5;\n            border-radius: 50%;\n            width: 24px;\n            height: 24px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-size: 0.8em;\n            margin-right: 8px;\n        }\n        \n        .cell-volts {\n            color: #e1e1e1;\n            font-family: monospace;\n        }\n        \n        .cell-res {\n            color: #90a4ae;\n            font-size: 0.85em;\n            font-family: monospace;\n        }\n\n        .cell-low { color: #FFA500; } /* Example warning color */\n        .cell-high { color: var(--discharge-color); }\n        \n        .status-on { color: var(--accent-color); font-weight: bold; }\n        .status-off { color: #666; font-weight: bold; }\n\n        .clickable { cursor: pointer; }\n\n        /* SVG Overlay for Lines */\n        .flow-svg {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            pointer-events: none;\n            z-index: 1;\n        }\n        \n        .flow-svg path {\n            fill: none;\n            stroke-width: 2;\n            stroke-dasharray: 8;\n            animation: flow 1s linear infinite;\n        }\n        \n        .path-charge { stroke: var(--accent-color); }\n        .path-discharge { stroke: var(--discharge-color); }\n        .path-inactive { stroke: #444; stroke-dasharray: 0; animation: none; }\n        \n        @keyframes flow {\n            from { stroke-dashoffset: 16; }\n            to { stroke-dashoffset: 0; }\n        }\n        \n        /* Sparkline CSS */\n        /* Sparkline CSS */\n        .metric-group {\n            position: relative;\n            width: 100%;\n            display: flex;\n            flex-direction: column;\n            align-items: center;\n            justify-content: center;\n            padding: 8px 0;\n            z-index: 1;\n        }\n\n        .sparkline-container {\n            position: absolute;\n            top: 0;\n            left: 0;\n            width: 100%;\n            height: 100%;\n            overflow: hidden;\n            opacity: 0.3;\n            z-index: -1;\n            pointer-events: none;\n        }\n        \n        .sparkline-svg {\n            width: 100%;\n            height: 100%;\n        }\n\n        .spark-line {\n            fill: none;\n            stroke-width: 2;\n            vector-effect: non-scaling-stroke;\n        }\n\n        .spark-area {\n            fill-opacity: 0.2;\n            stroke: none;\n        }\n    "])));__decorate([n()],JkBmsCoreReactorLayout.prototype,"hass",void 0);__decorate([n()],JkBmsCoreReactorLayout.prototype,"config",void 0);__decorate([n()],JkBmsCoreReactorLayout.prototype,"historyData",void 0);JkBmsCoreReactorLayout=__decorate([t('jk-bms-core-reactor-layout')],JkBmsCoreReactorLayout);

var _templateObject$1,_templateObject2$1,_templateObject3;var JkBmsCard_1;const CARD_VERSION=version;console.groupCollapsed("%c\uD83D\uDD0B JK-BMS Battery Card%c   ready!  \uD83D\uDE80 (v".concat(CARD_VERSION,")"),'background: linear-gradient(to right, #41cd52, #3090c7); color: white; font-weight: bold; padding: 2px 8px; border-radius: 6px;','background: none; color: #AAA; font-style: italic;');console.log('%c Docs:','color: #41cd52; font-weight: bold;','https://github.com/Pho3niX90/jk-bms-card');console.groupEnd();let JkBmsCard=JkBmsCard_1=class JkBmsCard extends i{setConfig(config){this._config=JkBmsCard_1.getStubConfig();this._config={...this._config,...config};console.log(this._config);}static getStubConfig(){return {title:localize("title"),prefix:"jk_bms",cellCount:16,cellColumns:2,cellLayout:"bankMode",tempSensorsCount:0,hasHeater:0,entities:Object.keys(EntityKey).reduce((acc,key)=>{acc[key]='';return acc;},{})};}static async getConfigElement(){await Promise.resolve().then(function () { return editor; });return document.createElement(EDITOR_NAME);}getCardSize(){return 3;}render(){globalData.hass=this.hass;if(!this.hass||!this._config)return x(_templateObject$1||(_templateObject$1=_taggedTemplateLiteral([""])));if(this._config.layout==='core-reactor'){return x(_templateObject2$1||(_templateObject2$1=_taggedTemplateLiteral(["<jk-bms-core-reactor-layout .hass="," .config=","></jk-bms-core-reactor-layout>"])),this.hass,this._config);}return x(_templateObject3||(_templateObject3=_taggedTemplateLiteral(["\n    <jk-bms-default-layout .hass="," .config = ","></jk-bms-default-layout>\n        "])),this.hass,this._config);}};__decorate([n()],JkBmsCard.prototype,"hass",void 0);__decorate([n()],JkBmsCard.prototype,"_config",void 0);JkBmsCard=JkBmsCard_1=__decorate([t(MAIN_NAME)],JkBmsCard);window.customCards.push({type:MAIN_NAME,name:'JK BMS Card',preview:true,description:localize('common.description'),configurable:true});

var _templateObject,_templateObject2;let JkBmsCardEditor=class JkBmsCardEditor extends i{constructor(){super(...arguments);this._computeLabelCallback=data=>localize("config.".concat(data.name))??data.name;}setConfig(config){this._config={...this._config,...config};}render(){if(!this._config||!this.hass){return x(_templateObject||(_templateObject=_taggedTemplateLiteral([""])));}const entityConfigs=Object.values(EntityKey).map(key=>({name:key,selector:{entity:{}}}));return x(_templateObject2||(_templateObject2=_taggedTemplateLiteral(["\n\t\t\t<ha-form\n\t\t\t\t.hass=","\n\t\t\t\t.data=","\n\t\t\t\t.computeLabel=","\n\t\t\t\t.schema=","\n\t\t\t\t@value-changed=","\n\t\t\t></ha-form>\n\t\t"])),this.hass,this._config,this._computeLabelCallback.bind(this),[{type:'grid',title:localize('config.title'),schema:[{type:'grid',schema:[{name:'title',selector:{text:{}}}]}]},{type:'grid',title:localize('config.prefix'),schema:[{type:'grid',schema:[{name:'prefix',selector:{text:{}}}]}]},{type:'grid',title:localize('config.layout'),schema:[{type:'grid',schema:[{name:'layout',selector:{select:{options:[{label:'Default',value:'default'},{label:'Core reactro',value:'core-reactor'}]}}}]}]},{type:'grid',title:localize('config.cellCount'),schema:[{type:'grid',schema:[{name:'cellCount',selector:{number:{min:2,max:48,step:2}}},{name:'cellColumns',selector:{number:{min:1,max:8,step:1}}},{name:'cellLayout',selector:{select:{options:[{label:'Incremental',value:'incremental'},{label:'Bank Mode',value:'bankMode'}]}}}]}]},{type:'grid',title:localize('config.tempSensorsCount'),schema:[{type:'grid',schema:[{name:'tempSensorsCount',selector:{number:{min:0,max:4,step:2}}}]}]},{type:'grid',title:localize('config.hasHeater'),schema:[{type:'grid',schema:[{name:'hasHeater',selector:{select:{multiple:false,mode:"list",options:[{label:"Yes",value:"1"},{label:"No",value:"0"}]}}}]}]},{type:'expandable',title:localize('config.manualAssignment'),schema:[{name:'entities',type:'grid',schema:entityConfigs}]}],this._valueChanged.bind(this));}_valueChanged(ev){fireEvent(this,'config-changed',{config:ev.detail.value});}};__decorate([n()],JkBmsCardEditor.prototype,"hass",void 0);__decorate([n()],JkBmsCardEditor.prototype,"_config",void 0);__decorate([n()],JkBmsCardEditor.prototype,"lovelace",void 0);JkBmsCardEditor=__decorate([t(EDITOR_NAME)],JkBmsCardEditor);

var editor = /*#__PURE__*/Object.freeze({
  __proto__: null,
  get JkBmsCardEditor () { return JkBmsCardEditor; }
});

export { CARD_VERSION, JkBmsCard };
